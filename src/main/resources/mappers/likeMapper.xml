<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.andy.recipe.like.repository.LikeRepository">

	<insert id="insertLike" parameterType="com.andy.recipe.like.domain.Like">
		INSERT 
		INTO 
		`post_like` 
		(
		`userId`, 
		`postId`, 
		`createdAt`
		)
		VALUES 
		(
		#{userId}, 
		#{postId}, 
		NOW()
		)
	</insert>
	
	<select id="countByPostId" parameterType="long" resultType="int">
		SELECT COUNT(*) FROM 
		`post_like` 
		WHERE 
		`postId` = #{postId}
	</select>

	<select id="existsByPostIdAndUserId" resultType="boolean">
		SELECT EXISTS (
		SELECT 1 FROM 
		`post_like` 
		WHERE 
		`postId` = #{postId} 
		AND 
		`userId` = #{userId}
		)
	</select>

</mapper>